{"version":3,"file":"./assets/js/dist/mpp-uploader.js","mappings":"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","sources":["webpack://mediapress/./assets/js/src/uploader.js","webpack://mediapress/./assets/js/src/utils/event-registry.js","webpack://mediapress/./assets/js/src/utils/media-utils.js","webpack://mediapress/external window \"Dropzone\"","webpack://mediapress/external window \"_\"","webpack://mediapress/external window \"jQuery\"","webpack://mediapress/webpack/bootstrap","webpack://mediapress/webpack/runtime/compat get default export","webpack://mediapress/webpack/runtime/define property getters","webpack://mediapress/webpack/runtime/hasOwnProperty shorthand","webpack://mediapress/webpack/runtime/make namespace object","webpack://mediapress/./assets/js/mpp-uploader.js"],"sourcesContent":["\n// If you are using JavaScript/ECMAScript modules:\nimport _ from 'underscore';\nimport $ from 'jquery';\nimport Dropzone from 'dropzone';\n\nimport EventRegistry from './utils/event-registry';\n// Keeps track of the uploader.\nwindow._mppUploaders = window._mppUploaders || {};\nexport default class Uploader {\n\n    constructor(id, args) {\n        this.id = id;\n\n        this.mediaType = args.mediType|| '';\n\n        this.allowedFileTypes = args.allowedFileTypes || null;\n\n        this.params = args.params || {};\n\n        this.$el = null;\n        this.$container = null;\n        this.$wrapper = null;\n        this.$feedback = null;\n        this.isResetting = false;\n        this.settings = _.extend({}, {\n            'paramName': '_mpp_file',\n            'showFeedback': true,\n        },\n            args\n        );\n\n        // default events map if passed.\n        this._events = ( args.events && _.isObject(args.events) ) ? args.events : {};\n        // keeps a list of all registered events and associated callbacks.\n        this._eventRegistry = new EventRegistry();\n\n        this._dropzone = null;\n        // is the Uploader enabled?\n        this._isEnabled = !!args.isEnabled;\n        this._initialized = false;\n        window._mppUploaders[this.id] = this;\n    }\n\n    // Initialize uploader.\n    init() {\n        // should we test if the uploader was initialized earlier?\n\n        if( this._initialized ) {\n            return false;\n        }\n\n        if( ! this.settings.el ) {\n            return false;\n        }\n\n        this.$el = $(this.settings.el);\n\n        if( ! this.$el.length ) {\n            return false;\n        }\n\n        this.$container = this.$el.parents('.mpp-media-upload-container');\n        this.$wrapper = this.$el.parents('.mpp-new-media-container');\n        this.$feedback = this.$container.find('.mpp-feedback ul');\n\n        this._initialized = true;\n        this._createDropzone();\n        this._bindEvents();\n\n        if( this.settings.help) {\n            this.updateHelpMessages(this.settings.help);\n        }\n    }\n\n    updateHelpMessages(helpMessage) {\n        if (!this.$container || !this.$container.length) {\n            return;\n        }\n\n        if (helpMessage.browse) {\n            this.$container.find('.dz-default .dz-button').html(helpMessage.browse);\n        }\n\n        if (helpMessage.allowedFileType) {\n            this.$container.find('.mpp-uploader-allowed-file-type-info').html(helpMessage.allowedFileType);\n        }\n\n        if (helpMessage.allowedFileType) {\n            this.$container.find('.mpp-uploader-allowed-max-file-size-info').html(helpMessage.fileSize);\n        }\n\n        this.showHelpMessages();\n    }\n\n    showHelpMessages() {\n        if (!this.$container || !this.$container.length) {\n            return;\n        }\n        this.$container.find('.mpp-dropzone-upload-help').show();\n    }\n\n    hideHelpMessages() {\n        if (!this.$container || !this.$container.length) {\n            return;\n        }\n        this.$container.find('.mpp-dropzone-upload-help').hide();\n    }\n\n\n    /**\n     * Creates a new dropzone.\n     */\n    _createDropzone() {\n        // when creating dropzone, use the\n        this.settings.acceptedFiles = this.allowedFileTypes;\n        //this.settings.accept = this.settings.accept || this.accept.bind(this);\n        this._dropzone = new Dropzone(this.$el.get(0), this.settings);\n    }\n\n    /**\n     * Binds various events.\n     */\n    _bindEvents() {\n\n        // attach extra parameters to Request when a new request is being created.\n        this.on('sending' , this._appendParametersToRequest.bind(this));\n        // on success.\n        this.on('success' , this._onSuccess.bind(this));\n        //on upload error.\n        this.on('error' , this._onError.bind(this));\n        // when the remove is clicked.\n        this.on('removedfile' , this._onFileRemove.bind(this));\n\n        let events = this._events || {};\n\n        for( let event in events ) {\n            let callback = events[event];\n            this.on(event ,callback);\n        }\n    }\n\n    accept(file, done) {\n    }\n\n    _onFileRemove(file ) {\n        if( ! file.attachmentID ) {\n            this.cleanFeedback(file);\n                return;\n        }\n\n        if( ! this.isResetting ) {\n            this._deleteMedia( file.attachmentID );\n        }\n    }\n\n    /// Trigger delete, deletes any trace of a Media\n    _deleteMedia (id) {\n\n        if (!id) {\n            return false;\n        }\n\n        let nonce = this.settings.params.deleteMediaNonce? this.settings.params.deleteMediaNonce: this.settings.params._wpnonce;\n\n        $.post(ajaxurl, {\n            action: 'mpp_delete_media',\n            media_id: id,\n            cookie: encodeURIComponent(document.cookie),\n            _wpnonce: nonce\n        }, function (response) {\n\n            if (typeof  response.success !== \"undefined\") {\n                mpp.notify(response.message);\n            } else {\n                mpp.notify(response.message);\n            }\n\n        }, 'json');\n\n        return false;\n    }\n\n    _onSuccess(file, response, e) {\n\n        if( ! _.isObject(response)) {\n            response = JSON.parse( response);\n        }\n\n        // Save file's attachmentID.\n        if( response.success ) {\n            file.attachmentID = response.data.id;\n        }\n        let data = response.data;\n        console.log(data.filename);\n    }\n\n    _onError(file, response, e ) {\n\n        if( ! _.isObject( response) || ! file.previewElement ) {\n            return;\n        }\n\n        let message;\n        file.previewElement.classList.add(\"dz-error\");\n\n        if (response.data && response.data.message ) {\n            message = response.data.message;\n        } else {\n            message = \"There was an issue uploading\";\n        }\n\n        for (let node of file.previewElement.querySelectorAll(\n            \"[data-dz-errormessage]\"\n        )) {\n            node.textContent = message;\n        }\n\n        this.$feedback.append(\n         `<li id=\"mpp-upload-feedback-${file.upload.uuid}\">${message}</li>`\n        );\n    }\n\n    _appendParametersToRequest(file, xhr, formData ) {\n\n        for( let paramName in this.params ) {\n            formData.set( paramName, this.params[paramName]);\n        }\n    }\n\n    cleanFeedback(file) {\n        this.$feedback.find(`#mpp-upload-feedback-${file.upload.uuid}`).remove();\n    }\n\n    /**\n     *\n     * @param event  name or map of event:callback\n     * @param callback Optional callback if event name is passed as first parameter.\n     * @returns {Uploader}\n     */\n    on(event, callback) {\n\n        if( ! this._dropzone) {\n           return this;\n        }\n\n        if( _.isObject( event ) ) {\n            for ( let evt in event) {\n                this._dropzone.on(event , event[evt]);\n                this._eventRegistry.add(event, event[evt]);\n            }\n        } else {\n            this._dropzone.on(event , callback);\n            this._eventRegistry.add(event, callback);\n        }\n\n        return this;\n    }\n\n    off(event, callback ) {\n\n        if (  this._dropzone) {\n            this._dropzone.off(event , callback);\n            this._eventRegistry.remove(event, callback);\n        }\n\n        return this;\n    }\n\n    getAttachedEvents(eventName) {\n        return this._eventRegistry.get(eventName);\n    }\n\n    getRegisteredEvents() {\n        return this._eventRegistry.getAll();\n    }\n\n    getAttachedCallbacks(event) {\n        return this._eventRegistry.get(event);\n    }\n\n    getMediaType() {\n        return this.mediaType;\n    }\n\n    setMediaType( type ) {\n        this.mediaType = type;\n    }\n\n    getAllowedFileTypes() {\n        return this.allowedFileTypes;\n    }\n\n    setAllowedFileTypes( types ) {\n        this.allowedFileTypes = _.isArray( types ) ? types.join(',') : types;\n    }\n\n    getParam(name) {\n        return this.params[name] || null;\n    }\n\n    setParam(name, val ) {\n       this.params[name] = val;\n       return this;\n    }\n\n    getParams() {\n        return this.params;\n    }\n\n    setParams(params) {\n        this.params = params;\n        return this;\n    }\n\n    getSettings() {\n        return this.settings;\n    }\n\n    updateSettings(settings) {\n        this.settings = _.isObject( settings ) ? settings : this.settings;\n    }\n\n    isEnabled() {\n      return  this._isEnabled;\n    }\n\n    disable() {\n        if( this._dropzone ) {\n            this._dropzone.disable();\n            this._isEnabled = false;\n        }\n    }\n\n    enable() {\n        if( this._dropzone ) {\n            this._dropzone.enable();\n        }\n    }\n\n    reset() {\n        this.isResetting = true;\n       // this.params = {};\n       // this.context = '';\n        if( this._dropzone) {\n            this._dropzone.removeAllFiles(true);\n        }\n\n        if (this.$wrapper && mpp && mpp.mediaUtils) {\n            mpp.mediaUtils.resetAttachedMedia(this.$wrapper);\n        }\n        this.isResetting = false;\n    }\n\n    destroy() {\n        this.isResetting = true;\n        if (this._dropzone) {\n            this._dropzone.destroy();\n        }\n        this._initialized = false;\n        delete window._mppUploaders[this.id];\n        this.isResetting = false;\n    }\n\n    /**\n     * Prints debug information.\n     */\n    debug() {\n\n        for ( let key in this) {\n            // do not print functions\n            // dom reference(non serializable)\n            // dropzone object(non serializable)\n            if( '$'=== key[0] || '_dropzone' === key ||  _.isFunction(this[key])) {\n                continue;\n            }\n\n            console.log( key + '=>' + JSON.stringify( this[key] ) );\n        }\n    }\n    getUploadedFiles() {\n        if( this._dropzone){\n            return this._dropzone.getFilesWithStatus(Dropzone.SUCCESS);\n        }\n        return [];\n    }\n\n    //Get all successful uploaded media ids\n    getUploadedMediaIDs() {\n        let mediaIDs = [], files = this.getUploadedFiles();\n        for (let file of files) {\n            if (!file.attachmentID) {\n                continue;\n            }\n\n            mediaIDs.push(file.attachmentID);\n        }\n        // include any appended media via other means(remote-media uses it currently).\n        if (this.$wrapper && mpp && mpp.mediaUtils) {\n            let attachedMediaIDs = mpp.mediaUtils.getAttachedMedia(this.$wrapper);\n            for (let mediaID of attachedMediaIDs) {\n                if (!mediaID) {\n                    continue;\n                }\n                mediaIDs.push(mediaID);\n            }\n        }\n\n        // also, we need to check for the\n        return mediaIDs;\n    }\n\n    refresh() {\n        if( this._dropzone) {\n            this.isResetting = true;\n            this._dropzone.removeAllFiles(true);\n            this.update({'allowedFileTypes': this.allowedFileTypes});\n            this.isResetting = false;\n        }\n    }\n    // Hides the UI.\n    hideUI() {\n        if( ! this.$wrapper ) {\n            return;\n        }\n\n        this.$wrapper.slideUp('slow', function () {\n            $(this).removeClass('mpp-new-media-container-active').addClass('mpp-new-media-container-inactive');\n        });\n    }\n\n    // Shows Ui back.\n    showUI() {\n\n        if( ! this.$wrapper ) {\n            return;\n        }\n\n        this.$wrapper.slideDown('slow', function () {\n            $(this).removeClass('mpp-new-media-container-inactive').addClass('mpp-new-media-container-active');\n        });\n\n        //this.$container.show();\n    }\n\n    isAttached() {\n        return !!this.$el;\n    }\n\n    openFileChooser(){\n        if( this._dropzone && this._dropzone.clickableElements.length ) {\n            let $el =$( this._dropzone.clickableElements[this._dropzone.clickableElements.length-1]).first();\n            if( $el.length ) {\n             $el.click();\n            }\n        }\n    }\n\n    update(options) {\n        let dropzone = this._dropzone;\n\n        if (!dropzone) {\n            return false;\n        }\n\n        if( options.allowedFileTypes ) {\n            this.settings.allowedFileTypes = options.allowedFileTypes;\n            dropzone.options.acceptedFiles = options.allowedFileTypes ;\n            dropzone.hiddenFileInput.setAttribute(\n                \"accept\",\n                dropzone.options.acceptedFiles\n            );\n        }\n\n        if( options.dictInvalidFileType ) {\n            dropzone.options.dictInvalidFileType = options.dictInvalidFileType;\n        }\n\n        return true;\n    }\n}\n","\n/// Event helper is based on Dropzone.js's Emitter class\n// @see https://github.com/dropzone/dropzone/blob/main/src/emitter.js\nexport default class EventRegistry {\n\n    constructor() {\n        this._callbacks = {};\n    }\n\n    // Add an event listener for given event\n    add(event, fn) {\n        // Create namespace for this event\n        if (!this._callbacks[event]) {\n            this._callbacks[event] = [];\n        }\n        this._callbacks[event].push(fn);\n        return this;\n    }\n\n    // Remove event listener for given event. If fn is not provided, all event\n    // listeners for that event will be removed. If neither is provided, all\n    // event listeners will be removed.\n    remove(event, fn) {\n        if (!this._callbacks || arguments.length === 0) {\n            this._callbacks = {};\n            return this;\n        }\n\n        // specific event\n        let callbacks = this._callbacks[event];\n        if (!callbacks) {\n            return this;\n        }\n\n        // remove all handlers\n        if (arguments.length === 1) {\n            delete this._callbacks[event];\n            return this;\n        }\n\n        // remove specific handler\n        for (let i = 0; i < callbacks.length; i++) {\n            let callback = callbacks[i];\n            if (callback === fn) {\n                callbacks.splice(i, 1);\n                break;\n            }\n        }\n\n        return this;\n    }\n\n    get(event) {\n        // specific event\n        let callbacks = this._callbacks[event];\n        if (!callbacks) {\n            return null;\n        }\n\n        return callbacks;\n    }\n\n    getAll() {\n        return this._callbacks;\n    }\n}\n","\nimport $ from 'jquery';\nimport _ from 'underscore';\n\nwindow._mppUploadSettings = window._mppUploadSettings || {};\n// private copy to avoid user modifications.\nconst uploadSettings = _.clone(_mppUploadSettings);\n\n/**\n * Retrieves acceptable file extensions for the given media type.\n *\n * @param {string} type media type(photo,video,audio etc).\n * @returns {string} comma separated file extension.\n */\nfunction getExtensions( type ) {\n    let typeInfo =  ( type && uploadSettings.types && uploadSettings.types[type] ) ? uploadSettings.types[type] : {};\n    return  ( typeInfo && typeInfo.extensions ) ? typeInfo.extensions : '';\n}\n\n/**\n * Set the accepted file types for the uploader.\n *\n * @param {mpp.Uploader} uploader uploader instance.\n *\n * @param {string} type media type('photo', 'audio', 'video' etc ).\n */\nfunction setupUploaderFileTypes(uploader, type) {\n\n    if (!uploadSettings || !uploadSettings.types) {\n        return;\n    }\n\n    if ( ! type && uploadSettings.current_type ) {\n        type = uploadSettings.current_type;\n    }\n\n    //if type is still not defined, go back\n    if ( !type ) {\n        return;\n    }\n    uploader.type = type;\n\n    uploader.setAllowedFileTypes(prepareExtensions(getExtensions(type)));\n    let allowedTypeMessage = uploadSettings.allowed_type_messages[type];\n    let broseMessage = uploadSettings.type_browser_messages[type];\n\n    uploader.updateHelpMessages({\n        browse: broseMessage,\n        fileSize: uploadSettings.max_allowed_file_size,\n        allowedFileType: allowedTypeMessage\n    });\n}\n\nfunction prepareExtensions(extension) {\n    if( ! extension || ! extension.length ) {\n        return '';\n    }\n\n    let exts = extension.split(','), preparedExts=[];\n    for( let extension of exts ) {\n        extension = extension.trim();\n\n        if ( ! extension.length ) {\n            continue;\n        }\n\n        if( '.' !== extension[0]) {\n            extension = '.' + extension;\n        }\n        preparedExts.push(extension);\n    }\n\n    return preparedExts.join(',');\n}\n\n/**\n *\n * @returns {Object}Get media attached to the activity form\n */\nfunction getAttachedMedia( $container ) {\n    let media =  $container.data('mpp-attached-media');\n    if( ! media || ! _.isArray(media)) {\n        media = [];\n    }\n\n    return media;\n}\n\n/**\n * Add a media to attachment list\n *\n * @param int media_id\n * @returns {undefined}\n */\nfunction addAttachedMedia($container, media_id) {\n    let attached_media = $container.data('mpp-attached-media');\n\n    if (!attached_media || !_.isArray(attached_media) ) {\n        attached_media = [];\n    }\n\n    attached_media.push(media_id);\n    $container.data('mpp-attached-media', attached_media);\n\n}\n\n/**\n * Remove an attached media id from dom\n *\n * @param int media_id\n * @returns {Boolean}\n */\nfunction removeAttachedMedia($container, media_id) {\n\n    var attached_media = $container.data('mpp-attached-media');\n\n    if (!attached_media) {\n        return false;\n    } else {\n        //attached_media = attached_media.split(',');\n        attached_media = _.without(attached_media, '' + media_id);\n    }\n\n    $container.data('mpp-attached-media', attached_media);\n}\n\nfunction resetAttachedMedia( $container ) {\n    $container.data('mpp-attached-media', []);\n}\n\nexport {\n    getExtensions,\n    prepareExtensions,\n    setupUploaderFileTypes,\n    getAttachedMedia,\n    addAttachedMedia,\n    removeAttachedMedia,\n    resetAttachedMedia,\n};\n","module.exports = window[\"Dropzone\"];","module.exports = window[\"_\"];","module.exports = window[\"jQuery\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// import for side effects.\nimport Uploader from \"./src/uploader\";\n\nimport * as mediaUtils from './src/utils/media-utils';\n\nlet mpp = window.mpp|| {};\nmpp.Uploader = Uploader;\nmpp.utils = {};\nmpp.mediaUtils = mediaUtils;\nwindow.mpp = mpp;\n"],"names":["window","_mppUploaders","Uploader","constructor","id","args","this","mediaType","mediType","allowedFileTypes","params","$el","$container","$wrapper","$feedback","isResetting","settings","_","_events","events","_eventRegistry","EventRegistry","_dropzone","_isEnabled","isEnabled","_initialized","init","el","$","length","parents","find","_createDropzone","_bindEvents","help","updateHelpMessages","helpMessage","browse","html","allowedFileType","fileSize","showHelpMessages","show","hideHelpMessages","hide","acceptedFiles","Dropzone","get","on","_appendParametersToRequest","bind","_onSuccess","_onError","_onFileRemove","event","callback","accept","file","done","attachmentID","_deleteMedia","cleanFeedback","nonce","deleteMediaNonce","_wpnonce","ajaxurl","action","media_id","cookie","encodeURIComponent","document","response","success","mpp","notify","message","e","JSON","parse","data","console","log","filename","previewElement","classList","add","node","querySelectorAll","textContent","append","upload","uuid","xhr","formData","paramName","set","remove","evt","off","getAttachedEvents","eventName","getRegisteredEvents","getAll","getAttachedCallbacks","getMediaType","setMediaType","type","getAllowedFileTypes","setAllowedFileTypes","types","join","getParam","name","setParam","val","getParams","setParams","getSettings","updateSettings","disable","enable","reset","removeAllFiles","mediaUtils","resetAttachedMedia","destroy","debug","key","stringify","getUploadedFiles","getFilesWithStatus","getUploadedMediaIDs","mediaIDs","files","push","attachedMediaIDs","getAttachedMedia","mediaID","refresh","update","hideUI","slideUp","removeClass","addClass","showUI","slideDown","isAttached","openFileChooser","clickableElements","first","click","options","dropzone","hiddenFileInput","setAttribute","dictInvalidFileType","_callbacks","fn","arguments","callbacks","i","splice","_mppUploadSettings","uploadSettings","getExtensions","typeInfo","extensions","setupUploaderFileTypes","uploader","current_type","prepareExtensions","allowedTypeMessage","allowed_type_messages","broseMessage","type_browser_messages","max_allowed_file_size","extension","exts","split","preparedExts","trim","media","addAttachedMedia","attached_media","removeAttachedMedia","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","utils"],"sourceRoot":""}