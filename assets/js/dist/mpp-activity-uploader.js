!function(){"use strict";var e,t,i,n={565:function(e,t,i){function n(e,t){var i;if(void 0===t||!t.length)return!1;for(var n=t.split("&"),o=0;o<n.length;o++)if((i=n[o].split("="))[0]==e)return i[1];return!1}i.d(t,{c:function(){return n}})},567:function(e){e.exports=window.jQuery},821:function(e){e.exports=window.mpp}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={exports:{}};return n[e](i,i.exports,a),i.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e=a(567),t=a.n(e),i=a(565),a(821),function(e){const t=_.clone(_mppUploadSettings),n=mpp.mediaUtils;function o(e){return"mpp-activity-uploader-"+e}function a(e){return _mppUploaders[e]?window._mppUploaders[e]:null}e(document).ready((function(){let r=e("#aw-whats-new-submit"),c=e("#mpp-activity-upload-buttons"),p=e("#whats-new-options"),d=n.getExtensions(t.current_type);c.length&&p.length&&p.prepend(c);let s=new mpp.Uploader("activity",{el:"#mpp-upload-dropzone-activity",url:t.url,params:_.extend({},t.params,{context:"activity"}),allowedFileTypes:n.prepareExtensions(d),addRemoveLinks:!0,events:{error:function(){r.prop("disabled",!1)},complete:function(){r.prop("disabled",!1)},allAdded:function(){r.prop("disabled",!0)}}});s.init(),e(document).on("click","#mpp-activity-upload-buttons a",(function(){return s.isAttached()&&(t.current_type=e(this).data("media-type"),n.setupUploaderFileTypes(s,t.current_type),s.refresh(),s.showUI(),t.activity_disable_auto_file_browser=parseInt(t.activity_disable_auto_file_browser,10),t.activity_disable_auto_file_browser||s.openFileChooser()),e(".mpp-remote-add-media-row-activity").show(),!1})),e(document).on("click",".mpp-activity-new-media-container .mpp-upload-container-close",(function(){return s.hideUI(),s.refresh(),!1})),e(document).ajaxSend((function(e,t,n){let r=null,c=null;switch((0,i.c)("action",n.data)){case"post_update":case"swa_post_update":c=s;break;case"new_activity_comment":c=a(o((0,i.c)("form_id",n.data)))}c&&(r=c.getUploadedMediaIDs().join(","),r&&(n.data=n.data+"&mpp-attached-media="+r,c.reset()))})),e(document).ajaxComplete((function(t,n,r){switch((0,i.c)("action",r.data)){case"post_update":case"swa_post_update":e(".mpp-remote-add-media-row-activity").hide(),s.hideUI(),s.refresh();break;case"new_activity_comment":let t=a(o((0,i.c)("form_id",r.data)));t&&(t.hideUI(),t.refresh())}})),e(document).on("click",".mpp-activity-comment-upload-buttons a",(function(){let i=e(this),r=i.closest(".mpp-activity-comment-upload-buttons"),c=r.closest(".comment-item"),p=r.length?r.data("activity-id"):0,d=0,s=i.data("media-type");c.length&&(d=c.data("bp-activity-comment-id")),function(){console.log(...arguments)}("Activity: "+p," , Comment ID: "+d);let l=o(p),u=a(l);return u&&(u.getParam("comment_id")!=d?(u.destroy(),u=null):u.type&&u.type!==s&&n.setupUploaderFileTypes(u,s)),u||(u=new mpp.Uploader(l,{el:"#mpp-upload-dropzone-activity-comment-"+p,url:t.url,params:_.extend({},t.params,{context:"activity-comment",activity_id:p}),allowedFileTypes:n.prepareExtensions(n.getExtensions(s)),addRemoveLinks:!0,help:{allowedFileType:t.allowed_type_messages[s],fileSize:t.max_allowed_file_size?t.max_allowed_file_size:"",browse:""},events:{error:function(){},complete:function(){},allAdded:function(){}}}),u.type=s,u.init()),u.setParam("comment_id",d),u.isAttached()&&(u.showUI(),t.activity_disable_auto_file_browser=parseInt(t.activity_disable_auto_file_browser,10),t.activity_disable_auto_file_browser||u.openFileChooser()),!1})),e(document).on("click",".mpp-activity-comment-new-media-container .mpp-upload-container-close",(function(){let t=e(this).data("activity-id");if(!t)return!1;let i=a(o(t));return i&&(i.hideUI(),i.refresh()),!1})),e(document).on("click",".acomment-reply",(function(){let t=a(o(e(this).closest(".activity-item").data("bp-activity-id")));t&&(t.hideUI(),t.destroy())}))}))}(t())}();
//# sourceMappingURL=mpp-activity-uploader.js.map